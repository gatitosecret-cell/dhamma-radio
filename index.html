<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>วิทยุธรรมะออนไลน์</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">

    <style>
        :root {
            --gold: #d4af37;
            --dark-brown: #3e2723;
            --bg-color: #f9f4e8;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: env(safe-area-inset-top) 20px 120px 20px; /* เว้นที่ด้านล่างให้ Player */
            color: var(--dark-brown);
        }
        .header {
            padding: 40px 0 20px;
            text-align: center;
        }
        .header h1 { font-size: 1.5rem; margin: 10px 0; }
        .header p { font-size: 0.9rem; opacity: 0.8; }

        .station-container {
            display: grid;
            gap: 15px;
        }
        .station-card {
            background: white;
            border-radius: 20px;
            padding: 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            border: 2px solid transparent;
        }
        .station-card:active { transform: scale(0.98); }
        .station-card.active { border-color: var(--gold); background: #fffdf7; }

        .station-card img {
            width: 70px;
            height: 70px;
            border-radius: 15px;
            object-fit: cover;
            margin-right: 20px;
        }
        .info { text-align: left; }
        .info b { font-size: 1.1rem; display: block; }
        .info span { font-size: 0.85rem; color: #777; }

        /* ตัวเล่นเพลงด้านล่าง */
        .player-bar {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: white;
            padding: 20px 20px calc(20px + env(safe-area-inset-bottom));
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            border-radius: 25px 25px 0 0;
            display: none;
            text-align: center;
        }
        .player-info { margin-bottom: 15px; font-weight: bold; }
        audio { width: 100%; height: 40px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>วิทยุธรรมะออนไลน์</h1>
        <p>ธรรมะเติมสุข ปลุกปัญญา</p>
    </div>

    <div class="station-container">
    <div class="station-card" onclick="playRadio('https://radio1.siamlivehost.com:8001/;', 'วัดปากบ่อ', this)">
        <img src="pakbo.png" alt="วัดปากบ่อ">
        <div class="info">
            <b>วัดปากบ่อ</b>
            <span>ธรรมะเติมสุข ปลุกปัญญา</span>
        </div>
    </div>

    <div class="station-card" onclick="playRadio('https://radio1.siamlivehost.com:4014/;', 'วัดทุ่งลานนา', this)">
        <img src="thunglanna.png" alt="วัดทุ่งลานนา">
        <div class="info">
            <b>วัดทุ่งลานนา</b>
            <span>ทุ่งธารธรรม</span>
        </div>
    </div>

    <div class="station-card" onclick="playRadio('https://radio3.siamlivehost.com:4106/;', 'วัดนายโรง', this)">
        <img src="nairong.png" alt="วัดนายโรง">
        <div class="info">
            <b>วัดนายโรง</b>
            <span>เสียงธรรมจากวัดนายโรง</span>
        </div>
    </div>
</div>

    <div class="player-bar" id="playerBar">
        <div class="player-info" id="currentStation">กำลังเลือกสถานี...</div>
        <audio id="mainAudio" controls preload="none"></audio>
    </div>

    <script>
        const audio = document.getElementById('mainAudio');
        const playerBar = document.getElementById('playerBar');
        const statusText = document.getElementById('currentStation');

function playRadio(url, name, element) {
    // 1. จัดการเรื่อง UI
    document.querySelectorAll('.station-card').forEach(el => el.classList.remove('active'));
    element.classList.add('active');
    playerBar.style.display = 'block';
    statusText.innerText = "กำลังเล่น: " + name;

    // 2. จัดการเรื่องเสียง (บังคับให้เปลี่ยน Source และเล่นใหม่)
    audio.pause();
    audio.src = url;
    audio.load(); // สำคัญมากเพื่อให้ Browser เตรียมข้อมูลใหม่
    
    // 3. แก้ปัญหาการบล็อก Autoplay
    var playPromise = audio.play();
    if (playPromise !== undefined) {
        playPromise.catch(error => {
            console.log("ระบบบล็อกการเล่นอัตโนมัติ: ", error);
            // ถ้าเล่นไม่ได้ ให้ผู้ใช้กดปุ่ม Play เองในแถบควบคุม
        });
    }
}
    </script>
</body>
</html>

